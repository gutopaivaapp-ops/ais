<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conectividade em Infusão: Dashboard Estratégico</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* Slate 50 */
            color: #334155; /* Slate 700 */
        }

        /* Chart Container Styling Rules - STRICT ADHERENCE */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px; /* Max width to prevent stretching */
            height: 300px;    /* Base height */
            max-height: 400px;
            margin-left: auto;
            margin-right: auto;
        }

        @media (min-width: 768px) {
            .chart-container {
                height: 350px; /* Taller on desktop */
            }
        }

        /* Custom Scrollbar for cleaner look */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        /* Animations */
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .nav-btn.active {
            background-color: #0f766e; /* Teal 700 */
            color: white;
            border-bottom: 2px solid #14b8a6; /* Teal 500 */
        }
    </style>

    <!-- Chosen Palette: Modern MedTech (Teal/Slate) -->
    <!-- 
         Primary: #0f766e (Teal 700)
         Secondary: #0e7490 (Cyan 700)
         Accent: #f59e0b (Amber 500 - for highlights)
         Background: #f8fafc (Slate 50)
         Text: #334155 (Slate 700)
    -->

    <!-- Application Structure Plan: 
         Structure: Single-page Dashboard with Tabbed Navigation.
         Why: The source report breaks down into three distinct "Pillars" (Clinical, Financial, Operational). 
         A tabbed interface allows the user to deep-dive into each pillar without being overwhelmed by a long scroll.
         Flow: 
         1. Hero/Executive Summary (High-level stats).
         2. Tab Interface to toggle between Safety, Finance, and Operations detailed views.
         3. Dynamic Charting area that updates based on the selected tab.
         4. Contextual details sidebar or bottom section for qualitative insights.
    -->

    <!-- Visualization & Content Choices:
         1. Executive Summary -> 3 Key Metric Cards (HTML/CSS) -> Goal: Inform immediately.
         2. Safety Pillar -> Comparative Bar Chart (Chart.js) -> Goal: Compare Standalone vs Interoperable effectiveness (28% vs 75%).
         3. Financial Pillar -> Horizontal Bar Chart (Chart.js) -> Goal: Compare Charge Capture ($2.4M) vs Cost Savings ($0.5M).
         4. Operational Pillar -> Line Chart (Chart.js) -> Goal: Show Change over time (Override reduction 58% -> 9%).
         5. Compliance -> Doughnut Chart (Chart.js) -> Goal: Inform simple proportion (98%).
         Confirmation: NO SVG graphics used. NO Mermaid JS used.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="flex flex-col min-h-screen">

    <!-- Navigation -->
    <nav class="bg-white shadow-md sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0 flex items-center gap-2">
                        <!-- CSS Icon for Medical Cross -->
                        <div class="w-8 h-8 bg-teal-700 rounded-lg flex items-center justify-center text-white font-bold text-lg">+</div>
                        <span class="font-bold text-xl text-slate-800 tracking-tight">Dashboard <span class="text-teal-600">Conectividade</span></span>
                    </div>
                </div>
                <!-- Desktop Nav -->
                <div class="hidden md:flex space-x-4 items-center">
                    <button onclick="switchTab('overview')" id="nav-overview" class="nav-btn active px-3 py-2 rounded-md text-sm font-medium text-slate-600 hover:bg-slate-100 transition-colors">Visão Geral</button>
                    <button onclick="switchTab('safety')" id="nav-safety" class="nav-btn px-3 py-2 rounded-md text-sm font-medium text-slate-600 hover:bg-slate-100 transition-colors">Segurança Clínica</button>
                    <button onclick="switchTab('finance')" id="nav-finance" class="nav-btn px-3 py-2 rounded-md text-sm font-medium text-slate-600 hover:bg-slate-100 transition-colors">Financeiro (ROI)</button>
                    <button onclick="switchTab('ops')" id="nav-ops" class="nav-btn px-3 py-2 rounded-md text-sm font-medium text-slate-600 hover:bg-slate-100 transition-colors">Operacional</button>
                </div>
                <!-- Mobile Menu Button -->
                <div class="flex items-center md:hidden">
                    <button onclick="document.getElementById('mobile-menu').classList.toggle('hidden')" class="text-slate-600 hover:text-slate-800 focus:outline-none p-2">
                        <span class="text-2xl">≡</span>
                    </button>
                </div>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden bg-white border-t border-slate-200">
            <div class="px-2 pt-2 pb-3 space-y-1">
                <button onclick="switchTab('overview')" class="block w-full text-left px-3 py-2 rounded-md text-base font-medium text-slate-700 hover:bg-slate-100">Visão Geral</button>
                <button onclick="switchTab('safety')" class="block w-full text-left px-3 py-2 rounded-md text-base font-medium text-slate-700 hover:bg-slate-100">Segurança Clínica</button>
                <button onclick="switchTab('finance')" class="block w-full text-left px-3 py-2 rounded-md text-base font-medium text-slate-700 hover:bg-slate-100">Financeiro (ROI)</button>
                <button onclick="switchTab('ops')" class="block w-full text-left px-3 py-2 rounded-md text-base font-medium text-slate-700 hover:bg-slate-100">Operacional</button>
            </div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full">
        
        <!-- Header Section -->
        <div class="mb-10 text-center md:text-left">
            <h1 class="text-3xl md:text-4xl font-extrabold text-slate-900">
                Conectividade em Infusão
            </h1>
            <p class="mt-2 text-lg text-slate-600 max-w-3xl">
                Análise baseada em evidências sobre os impactos clínicos, financeiros e operacionais da interoperabilidade entre bombas de infusão e prontuário eletrônico.
            </p>
        </div>

        <!-- Dynamic View Container -->
        <div id="view-container" class="space-y-8">
            <!-- Content injected by JS -->
        </div>

    </main>

    <!-- Footer -->
    <footer class="bg-slate-800 text-slate-300 py-8 mt-auto">
        <div class="max-w-7xl mx-auto px-4 grid grid-cols-1 md:grid-cols-2 gap-8">
            <div>
                <h3 class="text-white font-bold text-lg mb-2">Conclusão</h3>
                <blockquote class="italic text-slate-400 border-l-4 border-teal-500 pl-4">
                    "A evidência atual demonstra que o investimento em interoperabilidade se paga através da captura automática de receitas, enquanto eleva a segurança do paciente a um nível que a tecnologia isolada não consegue atingir."
                </blockquote>
            </div>
            <div>
                <h3 class="text-white font-bold text-lg mb-2">Fontes & Evidências (2025)</h3>
                <ul class="text-sm space-y-1">
                    <li>• Ohmann, B. et al. (2025) - Medical Devices: Evidence and Research.</li>
                    <li>• Giuliano, K. K. et al. (2025) - Journal of Medical Economics.</li>
                    <li>• Marwitz, K. et al. (2021/2022) - ANIA Annual Conference.</li>
                    <li>• ECRI Institute - Top 10 Health Technology Hazards.</li>
                </ul>
            </div>
        </div>
        
        <!-- Créditos do Autor -->
        <div class="max-w-7xl mx-auto px-4 mt-8 pt-8 border-t border-slate-700 text-center text-sm">
            <p class="text-slate-500">
                &copy; 2026 Dashboard Conectividade. Desenvolvido por <span class="text-slate-300 font-semibold">Augusto Pedro Paiva</span>.
            </p>
        </div>
    </footer>

    <!-- Templates for Views (Hidden, used by JS) -->
    <template id="tmpl-overview">
        <div class="fade-in space-y-8">
            <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-r-lg">
                <p class="text-blue-800 font-medium">
                    <strong>Resumo Executivo:</strong> A conectividade não é apenas TI. É a chave para reduzir erros em até 54% e recuperar milhões em receita perdida.
                </p>
            </div>

            <!-- Key Metrics Grid -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- Card 1 -->
                <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 hover:shadow-md transition-shadow">
                    <div class="flex items-center justify-between mb-4">
                        <div class="text-slate-500 font-medium text-sm uppercase tracking-wide">Segurança</div>
                        <div class="w-8 h-8 rounded-full bg-red-100 text-red-600 flex items-center justify-center font-bold">!</div>
                    </div>
                    <div class="text-4xl font-extrabold text-slate-900">54%</div>
                    <div class="text-sm text-green-600 font-semibold mb-2">↓ Redução de Erros</div>
                    <p class="text-slate-500 text-sm">Na administração de medicamentos com interoperabilidade total.</p>
                </div>

                <!-- Card 2 -->
                <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 hover:shadow-md transition-shadow">
                    <div class="flex items-center justify-between mb-4">
                        <div class="text-slate-500 font-medium text-sm uppercase tracking-wide">Financeiro</div>
                        <div class="w-8 h-8 rounded-full bg-green-100 text-green-600 flex items-center justify-center font-bold">$</div>
                    </div>
                    <div class="text-4xl font-extrabold text-slate-900">$2.4M</div>
                    <div class="text-sm text-green-600 font-semibold mb-2">↑ Recuperação Anual</div>
                    <p class="text-slate-500 text-sm">Em "Charge Capture" (faturamento recuperado) por ano.</p>
                </div>

                <!-- Card 3 -->
                <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 hover:shadow-md transition-shadow">
                    <div class="flex items-center justify-between mb-4">
                        <div class="text-slate-500 font-medium text-sm uppercase tracking-wide">Compliance</div>
                        <div class="w-8 h-8 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center font-bold">✓</div>
                    </div>
                    <div class="text-4xl font-extrabold text-slate-900">98%</div>
                    <div class="text-sm text-green-600 font-semibold mb-2">↑ Adesão</div>
                    <p class="text-slate-500 text-sm">Uso correto da biblioteca de drogas após integração.</p>
                </div>
            </div>

            <!-- Intro Text -->
            <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-8">
                <h2 class="text-2xl font-bold text-slate-800 mb-4">Por que priorizar a Conectividade?</h2>
                <p class="text-slate-600 leading-relaxed">
                    A administração de medicamentos IV é um processo complexo e propenso a erros. Embora as bombas inteligentes (Smart Pumps) tenham trazido avanços, elas isoladamente deixam lacunas de segurança (como erros de digitação e seleção de paciente).
                    <br><br>
                    Os dados apresentados neste dashboard, extraídos de estudos de 2025, provam que conectar a bomba ao prontuário (Interoperabilidade) fecha essas lacunas, gerando valor imediato em segurança, retorno financeiro e eficiência da equipe de enfermagem.
                </p>
                <div class="mt-6 flex justify-center">
                    <button onclick="switchTab('safety')" class="bg-teal-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-teal-700 transition-colors shadow-lg shadow-teal-600/20">
                        Explorar os Dados de Segurança &rarr;
                    </button>
                </div>
            </div>
        </div>
    </template>

    <template id="tmpl-safety">
        <div class="fade-in grid grid-cols-1 lg:grid-cols-2 gap-8">
            <div class="space-y-6">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                    <h2 class="text-2xl font-bold text-teal-800 mb-2">O Pilar Clínico</h2>
                    <p class="text-slate-600">
                        A integração fecha o ciclo da medicação. O principal risco eliminado é o <strong>erro de digitação (Keystroke Error)</strong>.
                    </p>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                    <h3 class="font-bold text-lg mb-3">O Problema da Bomba Isolada</h3>
                    <ul class="space-y-3">
                        <li class="flex items-start">
                            <span class="text-red-500 mr-2">✖</span>
                            <span class="text-slate-600 text-sm">Não previne erro de digitação de peso ou dose.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-red-500 mr-2">✖</span>
                            <span class="text-slate-600 text-sm">Não valida se é o paciente correto (troca de leito).</span>
                        </li>
                    </ul>
                </div>

                <div class="bg-teal-50 p-6 rounded-xl border border-teal-100">
                    <h3 class="font-bold text-lg text-teal-900 mb-3">A Solução: Interoperabilidade</h3>
                    <ul class="space-y-3">
                        <li class="flex items-start">
                            <span class="text-green-600 mr-2">✔</span>
                            <span class="text-slate-700 text-sm"><strong>Auto-programação:</strong> A bomba recebe os dados validados pelo médico.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-green-600 mr-2">✔</span>
                            <span class="text-slate-700 text-sm">Garante os <strong>"5 Certos"</strong> automaticamente.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-green-600 mr-2">✔</span>
                            <span class="text-slate-700 text-sm">Reduz erros de administração entre <strong>15% e 54%</strong>.</span>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- Chart Section -->
            <div class="bg-white p-6 rounded-xl shadow-lg border border-slate-200 flex flex-col justify-center">
                <h3 class="text-lg font-bold text-slate-700 mb-4 text-center">Eficácia na Prevenção de Erros</h3>
                <div class="chart-container">
                    <canvas id="chart-safety"></canvas>
                </div>
                <p class="text-center text-xs text-slate-400 mt-4">Fonte: DovePress (2025) - Systematic Literature Review</p>
            </div>
        </div>
    </template>

    <template id="tmpl-finance">
        <div class="fade-in space-y-8">
            <div class="bg-white p-8 rounded-xl shadow-sm border border-slate-200">
                <h2 class="text-2xl font-bold text-teal-800 mb-4">O Pilar Financeiro (ROI)</h2>
                <p class="text-slate-600 leading-relaxed">
                    Muitas instituições perdem dinheiro não por falta de atendimento, mas por falha no registro (*Charge Capture*). Quando uma infusão é iniciada ou titulada manualmente, o horário exato muitas vezes não é registrado, gerando glosas ou subfaturamento.
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Chart -->
                <div class="bg-white p-6 rounded-xl shadow-lg border border-slate-200">
                    <h3 class="text-lg font-bold text-slate-700 mb-4 text-center">Impacto Financeiro Anual (USD)</h3>
                    <div class="chart-container">
                        <canvas id="chart-finance"></canvas>
                    </div>
                    <p class="text-center text-xs text-slate-400 mt-4">Fonte: Journal of Medical Economics (2025)</p>
                </div>

                <!-- Details -->
                <div class="space-y-6">
                    <div class="bg-green-50 p-6 rounded-xl border-l-4 border-green-500">
                        <h3 class="font-bold text-green-900 text-lg">Recuperação de Receita</h3>
                        <div class="text-3xl font-bold text-green-700 my-2">$2.4 Milhões/Ano</div>
                        <p class="text-green-800 text-sm">
                            Em um sistema hospitalar analisado, a automação do registro de início/fim de infusões recuperou esse valor em cobranças que antes eram perdidas.
                        </p>
                    </div>

                    <div class="bg-blue-50 p-6 rounded-xl border-l-4 border-blue-500">
                        <h3 class="font-bold text-blue-900 text-lg">Economia Indireta (Segurança)</h3>
                        <div class="text-3xl font-bold text-blue-700 my-2">$531.000/Ano</div>
                        <p class="text-blue-800 text-sm">
                            Custo evitado no tratamento de complicações geradas por Eventos Adversos Preveníveis (pADEs) e dias extras de internação.
                        </p>
                    </div>
                    
                    <div class="bg-slate-100 p-4 rounded-lg">
                        <p class="text-sm text-slate-600">
                            <strong>Fluxo de Valor:</strong> Infusão Realizada &rarr; <span class="text-teal-600 font-bold">Registro Automático no EMR</span> &rarr; Faturamento Preciso (Zero Glosas de Registro).
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <template id="tmpl-ops">
        <div class="fade-in grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Left Column: Context -->
            <div class="lg:col-span-1 space-y-6">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                    <h2 class="text-2xl font-bold text-teal-800 mb-4">O Pilar Operacional</h2>
                    <p class="text-slate-600 text-sm mb-4">
                        A maior barreira para a adoção tecnológica é a percepção de "mais trabalho" ou "mais alarmes". A interoperabilidade, quando bem calibrada, faz o oposto.
                    </p>
                    <hr class="border-slate-100 my-4">
                    <h4 class="font-bold text-slate-700 mb-2">Auto-Programming</h4>
                    <p class="text-slate-500 text-sm">
                        O enfermeiro valida os dados em vez de digitar. Isso reduz a carga cognitiva e libera tempo para o cuidado direto.
                    </p>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200 flex flex-col items-center text-center">
                    <h3 class="text-lg font-bold text-slate-700 mb-4">Adesão (Compliance)</h3>
                    <div class="chart-container" style="height: 200px;">
                        <canvas id="chart-compliance"></canvas>
                    </div>
                    <p class="text-sm text-slate-600 mt-4">
                        Com a facilidade do sistema, o uso da biblioteca de drogas sobe para <strong>98%</strong>.
                    </p>
                </div>
            </div>

            <!-- Right Column: Workflow Chart -->
            <div class="lg:col-span-2">
                <div class="bg-white p-6 rounded-xl shadow-lg border border-slate-200 h-full">
                    <h3 class="text-xl font-bold text-slate-800 mb-2">Gestão de Alarmes e Overrides</h3>
                    <p class="text-slate-500 text-sm mb-6">
                        Evolução da taxa de alertas ignorados (Overrides) antes e depois da otimização dos dados da biblioteca (Data Cleansing).
                    </p>
                    <div class="chart-container">
                        <canvas id="chart-ops"></canvas>
                    </div>
                    <div class="mt-6 bg-yellow-50 p-4 rounded-lg border border-yellow-200">
                        <p class="text-sm text-yellow-800">
                            <strong>Insight:</strong> No início, a taxa de override era de 58% (Fadiga de Alarmes). Após o ajuste dos limites (Hard/Soft Limits) baseado em dados reais, caiu para <strong>9%</strong>. O sistema torna-se silencioso e seguro.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <script>
        // --- State Management ---
        const state = {
            currentTab: 'overview'
        };

        // --- DOM Elements ---
        const viewContainer = document.getElementById('view-container');
        const mobileMenu = document.getElementById('mobile-menu');

        // --- Data Handling ---
        // Data derived from source report
        const reportData = {
            safety: {
                labels: ['Bomba Isolada', 'Bomba + EMR (Integrada)'],
                data: [28, 75]
            },
            finance: {
                labels: ['Custo Evitado (Segurança)', 'Recuperação de Receita'],
                data: [531000, 2400000]
            },
            ops: {
                labels: ['Implementação Inicial', 'Ajuste de Limites', 'Otimização Final'],
                data: [58, 25, 9]
            },
            compliance: {
                data: [98, 2] // 98% compliance, 2% non-compliance
            }
        };

        // --- View Logic ---
        function switchTab(tabName) {
            state.currentTab = tabName;
            
            // Update Navigation UI
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
                if(btn.id === `nav-${tabName}`) btn.classList.add('active');
            });

            // Hide Mobile Menu after click
            if(!mobileMenu.classList.contains('hidden')) {
                mobileMenu.classList.add('hidden');
            }

            // Render Content
            renderView(tabName);
        }

        function renderView(viewName) {
            viewContainer.innerHTML = ''; // Clear container
            const template = document.getElementById(`tmpl-${viewName}`);
            
            if (template) {
                const clone = template.content.cloneNode(true);
                viewContainer.appendChild(clone);
                
                // Initialize Charts based on view
                setTimeout(() => {
                    if (viewName === 'safety') initSafetyChart();
                    if (viewName === 'finance') initFinanceChart();
                    if (viewName === 'ops') initOpsCharts();
                }, 100); // Small delay to ensure DOM is ready
            }
        }

        // --- Chart Initialization Functions ---

        // Helper for text wrapping
        function formatLabel(str, maxwidth = 20) {
            const sections = [];
            const words = str.split(" ");
            let temp = "";
            words.forEach(function(item, index) {
                if (temp.length > 0) {
                    const concat = temp + ' ' + item;
                    if (concat.length > maxwidth) {
                        sections.push(temp);
                        temp = item;
                    } else {
                        temp = concat;
                    }
                } else {
                    temp = item;
                }
            });
            if (temp.length > 0) sections.push(temp);
            return sections;
        }

        const commonChartOptions = {
            maintainAspectRatio: false,
            responsive: true,
            plugins: {
                tooltip: {
                    callbacks: {
                        title: function(tooltipItems) {
                            const item = tooltipItems[0];
                            const label = item.chart.data.labels[item.dataIndex];
                            if (Array.isArray(label)) return label.join(' ');
                            return label;
                        }
                    }
                }
            }
        };

        function initSafetyChart() {
            const ctx = document.getElementById('chart-safety').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: reportData.safety.labels.map(l => formatLabel(l)),
                    datasets: [{
                        label: 'Erros Prevenidos (%)',
                        data: reportData.safety.data,
                        backgroundColor: ['#94a3b8', '#0f766e'], // Slate vs Teal
                        borderRadius: 6
                    }]
                },
                options: {
                    ...commonChartOptions,
                    scales: {
                        y: { beginAtZero: true, max: 100, title: { display: true, text: '% Prevenção' } }
                    },
                    plugins: {
                        ...commonChartOptions.plugins,
                        legend: { display: false }
                    }
                }
            });
        }

        function initFinanceChart() {
            const ctx = document.getElementById('chart-finance').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: reportData.finance.labels.map(l => formatLabel(l)),
                    datasets: [{
                        label: 'Valor (USD)',
                        data: reportData.finance.data,
                        backgroundColor: ['#0e7490', '#10b981'], // Cyan vs Emerald
                        borderRadius: 6
                    }]
                },
                options: {
                    ...commonChartOptions,
                    indexAxis: 'y',
                    scales: {
                        x: { 
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) { return '$' + value / 1000000 + 'M'; }
                            }
                        }
                    },
                    plugins: {
                        ...commonChartOptions.plugins,
                        legend: { display: false }
                    }
                }
            });
        }

        function initOpsCharts() {
            // Line Chart for Overrides
            const ctxOps = document.getElementById('chart-ops').getContext('2d');
            new Chart(ctxOps, {
                type: 'line',
                data: {
                    labels: reportData.ops.labels.map(l => formatLabel(l)),
                    datasets: [{
                        label: 'Taxa de Override (%)',
                        data: reportData.ops.data,
                        borderColor: '#f59e0b', // Amber
                        backgroundColor: 'rgba(245, 158, 11, 0.1)',
                        fill: true,
                        tension: 0.3,
                        pointBackgroundColor: '#fff',
                        pointBorderColor: '#f59e0b',
                        pointRadius: 6
                    }]
                },
                options: {
                    ...commonChartOptions,
                    scales: {
                        y: { beginAtZero: true, max: 70, title: { display: true, text: '% Alertas Ignorados' } }
                    },
                    plugins: {
                        ...commonChartOptions.plugins,
                        legend: { display: false }
                    }
                }
            });

            // Doughnut Chart for Compliance
            const ctxComp = document.getElementById('chart-compliance').getContext('2d');
            new Chart(ctxComp, {
                type: 'doughnut',
                data: {
                    labels: ['Adesão', 'Não Adesão'],
                    datasets: [{
                        data: reportData.compliance.data,
                        backgroundColor: ['#0f766e', '#e2e8f0'],
                        borderWidth: 0
                    }]
                },
                options: {
                    ...commonChartOptions,
                    cutout: '70%',
                    plugins: {
                        legend: { position: 'bottom' }
                    }
                }
            });
        }

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            switchTab('overview');
        });

    </script>
</body>
</html>